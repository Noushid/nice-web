var app=angular.module("myApp",["ngRoute","ui.bootstrap","angularUtils.directives.dirPagination","ngFileUpload"]);app.config(["$routeProvider","$locationProvider","$qProvider",function(e,a,o){o.errorOnUnhandledRejections(!1),a.hashPrefix(""),e.when("/#/",{templateUrl:"",controller:"dashboardController"}).when("/news",{templateUrl:"news",controller:"newsController"}).when("/brochures",{templateUrl:"brochures",controller:"brochureController"}).when("/helpful-links",{templateUrl:"helpful-links",controller:"helpfulLinkController"}).when("/gallery",{templateUrl:"gallery",controller:"galleryController"}).when("/slide-images",{templateUrl:"slide-images",controller:"slideImageController"}).when("/blog",{templateUrl:"blog",controller:"blogController"}).when("/edit-profile",{templateUrl:"change"})}]),app.filter("startFrom",function(){return function(e,a){return a=+a,e.slice(a)}}),app.directive("fileModel",["$parse",function(e){return{restrict:"A",link:function(a,o,n){var t=e(n.fileModel),l=t.assign;a.filespre=[],o.bind("change",function(){angular.forEach(o[0].files,function(e){e.url=URL.createObjectURL(e),e.model=n.fileModel,a.filespre.push(e)}),a.$apply(function(){l(a,o[0].files)})})}}}]),app.directive("ngConfirmClick",[function(){return{link:function(e,a,o){var n=o.ngConfirmClick||"Are you sure?",t=o.confirmedClick;a.bind("click",function(a){window.confirm(n)&&e.$eval(t)})}}}]),app.controller("adminController",["$scope","$location","$http","$rootScope","$filter","$window","uibDateParser",function(e,a,o,n,t,l,r){function s(){var a=n.base_url+"admin/user";o.get(a).then(function(a){a.data&&(e.curuser=a.data.username,e.newuser.username=e.curuser)})}function i(a){var o=a.date;if("day"===a.mode)for(var n=new Date(o).setHours(0,0,0,0),t=0;t<e.events.length;t++){var l=new Date(e.events[t].date).setHours(0,0,0,0);if(n===l)return e.events[t].status}return""}e.error={};var d=e.baseUrl=a.protocol()+"://"+location.host+"/";n.base_url=d,n.public_url=e.baseUrl=a.protocol()+"://"+location.host,e.paginations=[5,10,20,25],e.numPerPage=10,e.user={},e.curuser={},e.newuser={},e.newuser={},n.loading=!1,n.url="dashboard",e.formdisable=!1,console.log(n.url),n.loading=!1,e.format="yyyy/MM/dd",function(){n.loading=!0;var e=n.base_url+"admin/check-thumb";o.post(e,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(e){console.log("success"),n.loading=!1},function(e){console.log("error"),n.loading=!1})}(),s(),e.login=function(){console.log("login");var a=new FormData;angular.forEach(e.user,function(e,o){a.append(o,e)});var t=n.base_url+"/login/verify";o.post(t,a,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(e){l.location.href=d+"admin/#"},function(a){console.log("login error"),console.log(a.data),e.error=a.data,e.showerror=!0})},e.changeProfile=function(){n.loading=!0;var a=new FormData;angular.forEach(e.newuser,function(e,o){a.append(o,e)});var t=n.base_url+"admin/change/submit";o.post(t,a,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){n.loading=!1,console.log("profile changed"),e.showmsg=!0,e.formdisable=!0},function(a){n.loading=!1,e.showerror=!0})},e.reset=function(){e.newuser={},s(),e.newuser.username=e.curuser,e.showerror=!1,e.showmsg=!1,e.formdisable=!1},e.cancel=function(){l.location.href="admin/#"},e.today=function(){e.date=new Date},e.today(),e.clear=function(){e.date=null},e.inlineOptions={customClass:i,minDate:new Date,showWeeks:!0},e.dateOptions={formatYear:"yy",maxDate:new Date(2020,5,22),minDate:new Date,startingDay:1},e.toggleMin=function(){e.inlineOptions.minDate=e.inlineOptions.minDate?null:new Date,e.dateOptions.minDate=e.inlineOptions.minDate},e.toggleMin(),e.open1=function(){e.popup1.opened=!0},e.open2=function(){e.popup2.opened=!0},e.setDate=function(a,o,n){e.date=new Date(a,o,n)},e.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],e.format=e.formats[0],e.altInputFormats=["M!/d!/yyyy"],e.popup1={opened:!1},e.popup2={opened:!1};var u=new Date;u.setDate(u.getDate()+1);var c=new Date;c.setDate(u.getDate()+1),e.events=[{date:u,status:"full"},{date:c,status:"partially"}]}]),app.controller("blogController",["$scope","$http","$rootScope","$location","Upload","$timeout","$filter",function(e,a,o,n,t,l,r){function s(){a.get(o.base_url+"admin/blog/get-all").then(function(a){a.data?(e.bloges=a.data,e.showtable=!0):(console.log("No data Found"),e.showtable=!1,e.message="No data found")})}e.bloges=[],e.newblog={},e.curblog={},e.files=[],e.showform=!1,e.message={},o.url=n.path().replace("/",""),e.uploaded=[],e.newblog.date=new Date,e.uploadstatus="",s(),e.newBlog=function(){e.newblog={},e.filespre=[],e.showform=!0},e.showForm=function(a){e.curblog=a,e.newblog=angular.copy(a),e.filespre=[],e.showform=!0},e.hideForm=function(){e.showform=!1,e.errFiles=""},e.addBlog=function(){o.loading=!0,e.newblog.date=r("date")(e.date,"yyyy-MM-dd");var n=new FormData;if(angular.forEach(e.newblog,function(e,a){n.append(a,e)}),n.append("uploaded",JSON.stringify(e.uploaded)),e.newblog.id){var t=o.base_url+"admin/blog/edit/"+e.newblog.id;a.post(t,n,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){e.bloges.push(a.data),s(),e.newblog={},e.showform=!1,o.loading=!1,e.files=""},function(a){console.log("edit Error :- Status :"+a.status+"data : "+a.data),o.loading=!1,e.files=""})}else{var t=o.base_url+"admin/blog/add";a.post(t,n,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){e.bloges.push(a.data),s(),e.newblog={},e.showform=!1,o.loading=!1,e.files=""},function(a){console.log("addError :- Status :"+a.status+"data : "+a.data),console.log(a.data),o.loading=!1,e.files=""})}},e.deleteBlog=function(n){o.loading=!0;var t=o.base_url+"admin/blog/delete/"+n.id;a.delete(t).then(function(a){var t=e.bloges.indexOf(n);e.bloges.splice(t,1),alert(a.data.msg),s(),o.loading=!1},function(e){console.log("Delete Error :- Status :"+e.status+"data : "+e.data),console.log(e.data),o.loading=!1})},e.uploadFiles=function(a,n){e.files=a,e.errFiles=n,angular.forEach(a,function(a){a.upload=t.upload({url:o.base_url+"admin/blog/upload",data:{file:a}}),a.upload.then(function(o){l(function(){e.uploaded=o.data,a.result=o.data})},function(a){a.status>0&&(e.errorMsg=a.status+": "+a.data)},function(e){a.progress=Math.min(100,parseInt(100*e.loaded/e.total))}),a.upload.xhr(function(o){e.abort=function(){o.abort(),e.uploadstatus=1,a.progressmsg="Canceled"}})})},e.deleteImage=function(n){o.loading=!0;var t=o.base_url+"admin/blog/delete-image/"+n.id;a.delete(t).then(function(a){console.log("image deleted"),delete e.newblog.thumbImgUrl,o.loading=!1},function(e){console.log("Delete Error :- Status :"+e.status+"data : "+e.data),console.log(e.data),o.loading=!1})}}]),app.controller("brochureController",["$scope","$http","$rootScope","$location","Upload","$timeout","$filter",function(e,a,o,n,t,l,r){function s(){a.get(o.base_url+"admin/brochure/get-all").then(function(a){a.data?(e.brochures=a.data,e.showtable=!0):(console.log("No data Found"),e.showtable=!1,e.message="No data found")})}e.brochures=[],e.newbrochure={},e.curbrochure={},e.files=[],e.showform=!1,e.message={},o.url=n.path().replace("/",""),e.uploaded=[],e.newbrochure.date=new Date,e.fileValidation={},e.uploadstatus="",s(),e.newBrochure=function(){e.newbrochure={},e.filespre=[],e.showform=!0},e.showForm=function(a){e.curbrochure=a,e.newbrochure=angular.copy(a),e.filespre=[],e.showform=!0},e.hideForm=function(){e.showform=!1,e.errFiles=""},e.addBrochure=function(){o.loading=!0,e.newbrochure.date=r("date")(e.date,"yyyy-MM-dd");var n=new FormData;if(angular.forEach(e.newbrochure,function(e,a){n.append(a,e)}),n.append("uploaded",JSON.stringify(e.uploaded)),e.newbrochure.id){var t=o.base_url+"admin/brochure/edit/"+e.newbrochure.id;a.post(t,n,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){e.brochures.push(a.data),s(),e.newbrochure={},e.showform=!1,o.loading=!1,e.files=""},function(a){console.log("edit Error :- Status :"+a.status+"data : "+a.data),o.loading=!1,e.files=""})}else{var t=o.base_url+"admin/brochure/add";a.post(t,n,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){e.brochures.push(a.data),s(),e.newbrochure={},e.showform=!1,o.loading=!1,e.files=""},function(a){console.log(a.data),console.log("addError :- Status :  "+a.status+"data : "+a.data),403==a.status&&(e.fileValidation.status=!0,e.fileValidation.msg=a.data.validation_error),console.log(a.data.validation_error),o.loading=!1,e.files=""})}},e.deleteBrochure=function(n){o.loading=!0;var t=o.base_url+"admin/brochure/delete/"+n.id;a.delete(t).then(function(a){var t=e.brochures.indexOf(n);e.brochures.splice(t,1),alert(a.data),s(),o.loading=!1},function(e){console.log("Delete Error :- Status :"+e.status+"data : "+e.data),console.log(e.data),o.loading=!1})},e.uploadFiles=function(a,n){e.files=a,e.errFiles=n,angular.forEach(a,function(a){a.upload=t.upload({url:o.base_url+"admin/brochure/upload",data:{file:a}}),a.upload.then(function(o){l(function(){e.uploaded=o.data,a.result=o.data})},function(a){a.status>0&&(e.errorMsg=a.status+": "+a.data)},function(e){a.progress=Math.min(100,parseInt(100*e.loaded/e.total))}),a.upload.xhr(function(o){e.abort=function(){o.abort(),e.uploadstatus=1,a.progressmsg="Canceled"}})})},e.deleteImage=function(n){o.loading=!0;var t=o.base_url+"admin/brochure/delete-image/"+n.id;a.delete(t).then(function(a){console.log("image deleted"),delete e.newbrochure.thumbImgUrl,o.loading=!1},function(e){console.log("Delete Error :- Status :"+e.status+"data : "+e.data),console.log(e.data),o.loading=!1})}}]),app.controller("galleryController",["$scope","$http","$rootScope","$location","Upload","$timeout","$filter",function(e,a,o,n,t,l,r){function s(){e.loading=!0,a.get(o.base_url+"admin/gallery/get-all").then(function(a){a.data?(e.galleries=a.data,e.showtable=!0,console.log(e.galleries),e.loading=!1):(console.log("No data Found"),e.showtable=!1,e.message="No data found",e.loading=!1)})}e.galleries=[],e.newgallery={},e.curgallery={},e.files=[],e.errFiles=[],e.showform=!1,e.message={},o.url=n.path().replace("/",""),e.uploaded=[],e.fileValidation={},s(),e.newGallery=function(){e.newgallery={},e.filespre=[],e.uploaded=[],e.files=[],e.errFiles=[],e.showform=!0},e.ShowForm=function(a){e.showform=!0,e.curgallery=a,e.newgallery=angular.copy(a),e.item_files=a.files},e.hideForm=function(){e.errFiles="",e.showform=!1},e.addGallery=function(){o.loading=!0;var n=new FormData;if(angular.forEach(e.newgallery,function(e,a){n.append(a,e)}),n.append("uploaded",JSON.stringify(e.uploaded)),e.newgallery.id){var t=o.base_url+"admin/gallery/edit/"+e.newgallery.id;a.post(t,n,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){e.galleries.push(a.data),s(),e.newgallery={},e.showform=!1,o.loading=!1,e.files=""},function(a){console.log("edit Error :- Status :"+a.status+"data : "+a.data),o.loading=!1,e.files=""})}else{var t=o.base_url+"admin/gallery/add";a.post(t,n,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){e.galleries.push(a.data),s(),e.newgallery={},e.showform=!1,o.loading=!1,e.files=""},function(a){console.log("addError :- Status :"+a.status+"data : "+a.data),console.log(a.data),o.loading=!1,e.files="",403==a.status&&(e.fileValidation.status=!0,e.fileValidation.msg=a.data.validation_error)})}},e.deleteGallery=function(n){o.loading=!0;var t=o.base_url+"admin/gallery/delete/"+n.id;a.delete(t).then(function(a){var t=e.galleries.indexOf(n);e.galleries.splice(t,1),alert(a.data.msg),s(),o.loading=!1},function(e){console.log("Delete Error :- Status :"+e.status+"data : "+e.data),console.log(e.data),o.loading=!1})},e.uploadFiles=function(a,n){angular.forEach(n,function(a){e.errFiles.push(a)}),angular.forEach(a,function(a){e.files.push(a),a.upload=t.upload({url:o.base_url+"admin/gallery/upload",data:{file:a}}),a.upload.then(function(o){l(function(){e.uploaded.push(o.data),a.result=o.data})},function(a){a.status>0&&(e.errorMsg=a.status+": "+a.data)},function(e){a.progress=Math.min(100,parseInt(100*e.loaded/e.total))})})},e.deleteImage=function(n){o.loading=!0;var t=o.base_url+"admin/gallery/delete-image/"+n.id;a.delete(t).then(function(a){console.log("image deleted");var t=e.item_files.indexOf(n);e.item_files.splice(t,1),o.loading=!1},function(e){console.log("Delete Error :- Status :"+e.status+"data : "+e.data),console.log(e.data),o.loading=!1})},e.showGalleryFiles=function(a){console.log(a),e.galleryfiles=a}}]),app.controller("helpfulLinkController",["$scope","$http","$rootScope","$location","Upload","$timeout","$filter",function(e,a,o,n,t,l,r){function s(){a.get(o.base_url+"admin/helpful-link/get-all").then(function(a){a.data?(e.links=a.data,e.showtable=!0):(console.log("No data Found"),e.showtable=!1,e.message="No data found")})}e.links=[],e.newlink={},e.curlink={},e.showform=!1,e.message={},o.url=n.path().replace("/",""),e.newlink.date=new Date,s(),e.newLink=function(){e.newlink={},e.filespre=[],e.showform=!0},e.showForm=function(a){e.curlink=a,e.newlink=angular.copy(a),e.filespre=[],e.showform=!0},e.hideForm=function(){e.showform=!1},e.addLink=function(){if(o.loading=!0,void 0!=e.newlink.link){var n=e.newlink.link;~n.indexOf("http")||(e.newlink.link="http://"+n)}var t=new FormData;if(angular.forEach(e.newlink,function(e,a){t.append(a,e)}),e.newlink.id){var l=o.base_url+"admin/helpful-link/edit/"+e.newlink.id;a.post(l,t,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){e.links.push(a.data),s(),e.newlink={},e.showform=!1,o.loading=!1,e.files=""},function(a){console.log("edit Error :- Status :"+a.status+"data : "+a.data),o.loading=!1,e.files=""})}else{var l=o.base_url+"admin/helpful-link/add";a.post(l,t,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){e.links.push(a.data),s(),e.newlink={},e.showform=!1,o.loading=!1,e.files=""},function(a){console.log("addError :- Status :"+a.status+"data : "+a.data),console.log(a.data),o.loading=!1,e.files=""})}},e.deleteLink=function(n){o.loading=!0;var t=o.base_url+"admin/helpful-link/delete/"+n.id;a.delete(t).then(function(a){var t=e.links.indexOf(n);e.links.splice(t,1),alert(a.data),s(),o.loading=!1},function(e){console.log("Delete Error :- Status :"+e.status+"data : "+e.data),console.log(e.data),o.loading=!1})}}]),app.controller("newsController",["$scope","$http","$rootScope","$location","Upload","$timeout","$filter",function(e,a,o,n,t,l,r){function s(){a.get(o.base_url+"admin/news/get-all").then(function(a){a.data?(e.newses=a.data,e.showtable=!0):(console.log("No data Found"),e.showtable=!1,e.message="No data found")})}e.newses=[],e.newnews={},e.curnews={},e.files=[],e.showform=!1,e.message={},o.url=n.path().replace("/",""),e.uploaded=[],e.newnews.date=new Date,s(),e.newNews=function(){e.newnews={},e.filespre=[],e.showform=!0},e.showForm=function(a){e.curnews=a,e.newnews=angular.copy(a),e.filespre=[],e.showform=!0},e.hideForm=function(){e.showform=!1,e.errFiles=""},e.addNews=function(){o.loading=!0,e.newnews.date=r("date")(e.date,"yyyy-MM-dd");var n=new FormData;if(angular.forEach(e.newnews,function(e,a){n.append(a,e)}),n.append("uploaded",JSON.stringify(e.uploaded)),e.newnews.id){var t=o.base_url+"admin/news/edit/"+e.newnews.id;a.post(t,n,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){e.newses.push(a.data),s(),e.newnews={},e.showform=!1,o.loading=!1,e.files=""},function(a){console.log("edit Error :- Status :"+a.status+"data : "+a.data),o.loading=!1,e.files=""})}else{var t=o.base_url+"admin/news/add";a.post(t,n,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){e.newses.push(a.data),s(),e.newnews={},e.showform=!1,o.loading=!1,e.files=""},function(a){console.log("addError :- Status :"+a.status+"data : "+a.data),console.log(a.data),o.loading=!1,e.files=""})}},e.deleteNews=function(n){o.loading=!0;var t=o.base_url+"admin/news/delete/"+n.id;a.delete(t).then(function(a){var t=e.newses.indexOf(n);e.newses.splice(t,1),alert(a.data),s(),o.loading=!1},function(e){console.log("Delete Error :- Status :"+e.status+"data : "+e.data),console.log(e.data),o.loading=!1})},e.uploadFiles=function(a,n){e.files=a,e.errFiles=n,angular.forEach(a,function(a){a.upload=t.upload({url:o.base_url+"admin/news/upload",data:{file:a}}),a.upload.then(function(o){l(function(){e.uploaded=o.data,a.result=o.data})},function(a){a.status>0&&(e.errorMsg=a.status+": "+a.data)},function(e){a.progress=Math.min(100,parseInt(100*e.loaded/e.total)),a.progressmsg=Math.min(100,parseInt(100*e.loaded/e.total))}),a.upload.xhr(function(o){e.abort=function(){o.abort(),e.uploadstatus=1,a.progressmsg="Canceled"}})})},e.deleteImage=function(n){o.loading=!0;var t=o.base_url+"admin/news/delete-image/"+n.id;a.delete(t).then(function(a){console.log("image deleted"),delete e.newnews.thumbImgUrl,o.loading=!1},function(e){console.log("Delete Error :- Status :"+e.status+"data : "+e.data),console.log(e.data),o.loading=!1})}}]),app.controller("slideImageController",["$scope","$http","$rootScope","$location","Upload","$timeout","$filter",function(e,a,o,n,t,l,r){function s(){a.get(o.base_url+"admin/slide-images/get-all").then(function(a){a.data?(e.slideimages=a.data,e.showtable=!0):(console.log("No data Found"),e.showtable=!1,e.message="No data found")})}e.slideimages=[],e.newslideimages={},e.curslideimages={},e.showform=!1,e.message={},o.url=n.path().replace("/",""),e.uploaded=[],s(),e.newSlideImage=function(){e.newslideimages={},e.filespre=[],e.showform=!0},e.showForm=function(a){e.curslideimages=a,e.newslideimages=angular.copy(a),e.filespre=[],e.showform=!0},e.hideForm=function(){e.showform=!1,e.errFiles=""},e.addSlideImage=function(){o.loading=!0;var n=new FormData;n.append("uploaded",JSON.stringify(e.uploaded));var t=o.base_url+"admin/slide-images/add";a.post(t,n,{transformRequest:angular.identity,headers:{"Content-Type":void 0,"Process-Data":!1}}).then(function(a){e.slideimages.push(a.data),s(),e.newslideimages={},e.showform=!1,o.loading=!1,e.files=""},function(a){console.log("addError :- Status :"+a.status+"data : "+a.data),console.log(a.data),o.loading=!1,e.files=""})},e.uploadFiles=function(a,n){e.uploaded=[],e.files=a,e.errFiles=n,angular.forEach(a,function(a){a.upload=t.upload({url:o.base_url+"admin/slide-images/upload",data:{file:a}}),a.upload.then(function(o){l(function(){e.uploaded.push(o.data),a.result=o.data})},function(a){a.status>0&&(e.errorMsg=a.status+": "+a.data)},function(e){a.progress=Math.min(100,parseInt(100*e.loaded/e.total))})})},e.deleteImage=function(n){o.loading=!0;var t=o.base_url+"admin/slide-images/delete/"+n.id;a.delete(t).then(function(a){console.log("image deleted");var t=e.slideimages.indexOf(n);e.slideimages.splice(t,1),o.loading=!1},function(e){console.log("Delete Error :- Status :"+e.status+"data : "+e.data),console.log(e.data),o.loading=!1})}}]);